os: Windows Server 2012 R2
stack: go 1.10

clone_folder: c:\gopath\src\github.com\kung-foo\certgrep

install:
  - cinst 7zip.commandline
  - cinst winpcap
  - appveyor DownloadFile http://www.winpcap.org/install/bin/WpdPack_4_1_2.zip
  - 7za x .\WpdPack_4_1_2.zip -oc:\
  - ps: >-
      if(!(Test-Path "C:\tools\mingw64\bin\gcc.exe")) {
        cinst mingw
      }
  - set PATH=C:\tools\mingw64\bin;%GOROOT%\bin;%PATH%

cache:
  - C:\ProgramData\chocolatey\bin -> appveyor.yml
  - C:\ProgramData\chocolatey\lib -> appveyor.yml
  - C:\tools\mingw64 -> appveyor.yml

environment:
  GOPATH: c:\gopath

build_script:
  - go build -o dist\certgrep.exe cmd\certgrep\main.go

artifacts:
  - path: dist\certgrep.exe
